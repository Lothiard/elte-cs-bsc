<Window x:Class="ELTE.TicTacToeGame.View.TicTacToeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Tic-Tac-Toe" Height="350" Width="315" MinHeight="350" MinWidth="315">
    
    <Window.InputBindings>
        <!-- billentyű kezelése -->
        <KeyBinding Modifiers="Control" Key="N" Command="{Binding NewGameCommand}" />
        <KeyBinding Modifiers="Control" Key="L" Command="{Binding LoadGameCommand}" />
        <KeyBinding Modifiers="Control" Key="S" Command="{Binding SaveGameCommand}"  />
        <KeyBinding Modifiers="Control" Key="X" Command="{Binding ExitGameCommand}" />
    </Window.InputBindings>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- menü -->
        <Menu Grid.Row="0">
            <MenuItem Header="Játék">
                <MenuItem Header="Új" Command="{Binding NewGameCommand}" />
                <Separator />
                <MenuItem Header="Játék betöltése..." Command="{Binding LoadGameCommand}" />
                <MenuItem Header="Játék mentése..." Command="{Binding SaveGameCommand}" />
                <Separator />
                <MenuItem Header="Kilépés" Command="{Binding ExitGameCommand}" />
            </MenuItem>
        </Menu>

        <Viewbox Grid.Row="1">
            <!-- a tartalom automatikusan zoomolva lesz -->
            <ItemsControl ItemsSource="{Binding Fields}" Width="300" Height="300">
                <ItemsControl.Resources>
                    <Style x:Key="buttonStyle" TargetType="Button">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate>
                                    <Rectangle Fill="White" Stroke="LightGray" />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Player}" Value=" ">
                                <Setter Property="Template">
                                    <!-- a gomb sablonját cserélgetjük -->
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <Rectangle Fill="White" Stroke="LightGray" />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Player}" Value="X">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <!-- lehet összetett vezérlő is -->
                                            <Canvas Background="White">
                                                <Line X1="20" Y1="20" X2="80" Y2="80" Stroke="Orange" StrokeThickness="3" />
                                                <Line X1="80" Y1="20" X2="20" Y2="80" Stroke="Orange" StrokeThickness="3" />
                                            </Canvas>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Player}" Value="O">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <Canvas Background="White">
                                                <Ellipse Canvas.Left="20" Canvas.Top="20" Width="60" Height="60" Stroke="Orange" Fill="Yellow"/>
                                            </Canvas>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ItemsControl.Resources>
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <!-- az elemeket sorfolytonosan helyezzük el -->
                        <WrapPanel FlowDirection="LeftToRight" ItemHeight="100" ItemWidth="100" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <!-- a rácsba gombokat helyezünk el, amelyeken megjelenítjük a karaktert -->
                        <Button Command="{Binding FieldChangeCommand}" CommandParameter="{Binding}" Style="{StaticResource buttonStyle}" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Viewbox>

    </Grid>
</Window>